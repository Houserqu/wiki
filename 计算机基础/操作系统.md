# 操作系统

> [计算机操作系统](https://github.com/CyC2018/CS-Notes/blob/master/notes/%E8%AE%A1%E7%AE%97%E6%9C%BA%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%20-%20%E7%9B%AE%E5%BD%95.md)
> [[5万字、97 张图总结操作系统核心知识点](https://www.cnblogs.com/cxuanBlog/p/13297199.html)](https://www.cnblogs.com/cxuanBlog/p/13297199.html)

操作系统是一种软件，为运行其上的用户软件提供了简单、易于理解的计算机模型（文件、进程、内存等）和统一的接口，对底层硬件进行调度和管理。

## 硬件

![img](http://qiniu.houserqu.com/1515111-20200714084619096-571366405.png)

### CPU

> 运算器+控制器组成CPU

![img](http://qiniu.houserqu.com/1515111-20200714084613666-1629003807-20210705213655025.png)

#### 运算器

执行算数和各种逻辑运算的部件，主要由算数逻辑单元和寄存器构成。

#### 控制器

指按照指定顺序改变主电路或控制电路的部件，它主要起到了控制命令执行的作用，完成协调和指挥整个计算机系统的操作。控制器是由程序计数器、指令寄存器、解码译码器等构成。

#### 架构

- ARM: 移动设备处理器如高通、apple A系列、M系列
- x86系列: intel、amd
- MIPS: 龙芯中央处理器

### 存储器

记忆设备，分内存（临时存储设备，与CPU交互）和外存（硬盘等外部存储设备）

字节(Byte)是计量单位，表示数据量多少，是计算机信息技术用于计量存储容量的一种计量单位，通常情况下一字节等于八位。

字符(Character)计算机中使用的字母、数字、字和符号，比如'A'、'B'、'$'、'&'等。

一般在英文状态下一个字母或字符占用一个字节，一个汉字用两个字节表示。

![img](https://www.runoob.com/wp-content/uploads/2020/05/242dd42a2834349bfaa71500c4ea15ce37d3be96.jpeg)

**字节与字符：**

- ASCII 码中，一个英文字母（不分大小写）为一个字节，一个中文汉字为两个字节。
- UTF-8 编码中，一个英文字为一个字节，一个中文为三个字节。
- Unicode 编码中，一个英文为一个字节，一个中文为两个字节。
- 符号：英文标点为一个字节，中文标点为两个字节。例如：英文句号 **.** 占1个字节的大小，中文句号 **。**占2个字节的大小。
- UTF-16 编码中，一个英文字母字符或一个汉字字符存储都需要 2 个字节（Unicode 扩展区的一些汉字存储需要 4 个字节）。
- UTF-32 编码中，世界上任何字符的存储都需要 4 个字节。

### I/O 设备

与计算机进行通信的外部硬件。

块存储设备：有固定大小的块和物理地址，例如光盘、U盘。

字符设备：以字符为单位发送或接受字符流，没有块结构和地址，例如网络设备、打印机、鼠标。

![img](http://qiniu.houserqu.com/1515111-20200714085850421-283295504.png)

## 进程

进程是对正在运行中的程序的一个抽象，CPU 会在进程间快速切换。进程是某一类特定活动的总和，它有程序、输入输出以及状态。**进程是线程的容器**，进程是资源分配的基本单位。

在 UNIX 中，进程和它的所有子进程以及子进程的子进程共同组成一个进程组。整个操作系统中所有的进程都隶属于一个单个以 init 为根的进程树。

进程间通信：信号、管道、命名管道、共享内存、消息队列、Socket（网络通信）

## 线程

一个进程下的线程共享内存，可以互相操作堆栈。线程是CPU调度的基本单位。

POSIX 是系统调用接口标准，不同的操作系统按照该标准提供接口，应用程序只需要按照该接口标准进行开发。

## 调度

多道程序设计系统中，需要**调度程序**来决定接下来要执行的进程/线程。**调度算法**主要有三类：批处理、交互式、实时。

## 内存

![img](http://qiniu.houserqu.com/1515111-20200714085127470-1663371494.png)

一种内存抽象模型，映射到物理内存上。

交换：空闲的进程的内存移动到磁盘上保存，运行到时候再移入到内存。

虚拟内存：可以将磁盘空间作为内存空间供系统调用，这一部分空间称为虚拟内存。

## 文件

文件是对磁盘存储数据的抽象。

## 系统

### 类别

- Windows
- UNIX
- Linux
- MacOS: drawin
- Android
- IOS

## 常见术语

- Throughput（吞吐量）：单位时间内能成功传送的数据数量（字节、请求数量）。指系统等抗压、负载能力
- QPS（每秒查询量）：每秒能够响应的查询（请求）次数。
- TPS（每秒事务数）：每秒处理的事务数。一个事物  >= 查询次数。
- RT（响应时间）：指系统对请求作出响应的时间，一般取平均响应时间。
- 并发数：系统可以同时处理的请求/事务/用户数量。
- 最佳线程数：((线程等待时间 + 线程CPU时间) / 线程CPU时间) * CPU核心数。超过最佳线程数，QPS会下降。
- 最大QPS=最佳线程数 * 单线程QPS = (RT/CPU Time * CPU核心数 * CPU利用率) * (1/RT) = CPU核心数 * CPU利用率/CPUTime
- speedup（加速比）：同一个任务在单处理器系统和并行处理器系统中运行消耗的时间的比率。衡量并行的性能。
- 二八定律：每天 80% 的访问集中在 20% 的时间里。
- 计算 QPS：
  - 峰值时间每秒请求数(QPS) = ( 每天总PV数 * 80% ) / ( 每天秒数 * 20% )
  - 需要的机器 = 峰值时间每秒请求数(QPS) / 单台机器的QPS
